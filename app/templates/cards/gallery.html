{% extends "base.html" %}

{% block title %}Scholaverse - 我的卡牌{% endblock %}

{% block content %}
<div class="mb-6">
  <h1 class="pixel-title text-lg sm:text-xl mb-2">我的卡牌收藏</h1>
  <p class="text-rpg-text-dim text-sm">你的角色卡牌歷史紀錄</p>
</div>

{% if cards %}
<!-- Desktop: Grid layout / Mobile: Horizontal scroll -->
<div class="hidden md:grid md:grid-cols-3 lg:grid-cols-4 gap-6 mb-6">
  {% for card in cards %}
  <a href="/cards/{{ card.id }}" class="block group">
    <div class="card-frame card-frame-{{ card.border_style | default('copper') }} flex flex-col items-center p-3 bg-rpg-bg-deep">
      <div class="w-full aspect-[3/4] mb-3 overflow-hidden flex items-center justify-center bg-rpg-bg">
        {% if card.thumbnail_url or card.image_url %}
        <img src="{{ card.thumbnail_url or card.image_url }}"
             alt="卡牌 Lv.{{ card.level_number | default('?') }}"
             class="w-full h-full object-cover" style="image-rendering: pixelated;">
        {% else %}
        <img src="/static/images/placeholder/card_placeholder_thumb.svg"
             alt="卡牌預覽" class="w-16 h-16 opacity-50">
        {% endif %}
      </div>
      <div class="text-center w-full">
        <p class="text-rpg-gold font-mono text-sm font-bold">Lv.{{ card.level_number | default('?') }}</p>
        {% if card.is_latest %}
        <span class="inline-block mt-1 px-2 py-0.5 text-[10px] bg-rpg-gold/20 text-rpg-gold border border-rpg-gold">最新</span>
        {% endif %}
        <p class="text-rpg-text-dim text-[10px] mt-1">
          {{ card.created_at.strftime('%Y-%m-%d') if card.created_at else '' }}
        </p>
      </div>
    </div>
  </a>
  {% endfor %}
</div>

<!-- Mobile: Horizontal scroll -->
<div class="md:hidden card-scroll flex gap-4 pb-4 mb-6">
  {% for card in cards %}
  <a href="/cards/{{ card.id }}" class="block flex-shrink-0 w-40">
    <div class="card-frame card-frame-{{ card.border_style | default('copper') }} flex flex-col items-center p-2 bg-rpg-bg-deep">
      <div class="w-full aspect-[3/4] mb-2 overflow-hidden flex items-center justify-center bg-rpg-bg">
        {% if card.thumbnail_url or card.image_url %}
        <img src="{{ card.thumbnail_url or card.image_url }}"
             alt="卡牌 Lv.{{ card.level_number | default('?') }}"
             class="w-full h-full object-cover" style="image-rendering: pixelated;">
        {% else %}
        <img src="/static/images/placeholder/card_placeholder_thumb.svg"
             alt="卡牌預覽" class="w-12 h-12 opacity-50">
        {% endif %}
      </div>
      <div class="text-center w-full">
        <p class="text-rpg-gold font-mono text-xs font-bold">Lv.{{ card.level_number | default('?') }}</p>
        {% if card.is_latest %}
        <span class="inline-block mt-1 px-1 py-0.5 text-[8px] bg-rpg-gold/20 text-rpg-gold border border-rpg-gold">最新</span>
        {% endif %}
      </div>
    </div>
  </a>
  {% endfor %}
</div>

<p class="text-rpg-text-dim text-xs text-center">點擊卡牌查看詳細資訊</p>

{% else %}
<!-- No Cards -->
<div class="pixel-panel">
  <div class="text-center py-8">
    <p class="text-rpg-text-dim text-4xl mb-3">?</p>
    <p class="text-rpg-text-dim text-sm mb-2">尚無卡牌。</p>
    <p class="text-rpg-text-dim text-xs mb-4">完成學習單元並配置角色屬性後即可生成卡牌。</p>
    <a href="/progress" class="pixel-btn text-xs">前往學習歷程</a>
  </div>
</div>
{% endif %}
{% endblock %}
